source /usr/local/opt/chruby/share/chruby/chruby.sh

dotenv_if_exists ~/.env

PATH_add /usr/local/opt/imagemagick@6/bin
PATH_add /usr/local/opt/openssl@1.1/bin
PATH_add /usr/local/opt/percona-server@5.6/bin

# Install rmagick with Bundler
export PKG_CONFIG_PATH="/usr/local/opt/imagemagick@6/lib/pkgconfig"

# Use locally defined Ruby version if available
use_ruby() {
  local version="$1"

  if [[ -z $version && -e .ruby-version ]]; then
    version=$(cat .ruby-version)
  fi

  if [[ -z $version ]]; then
    log_error "No Ruby version specified"
  else
    chruby $version
  fi
}

# Project-specific Vim configuration, experimental...
add_extra_vimrc() {
  local extravim="$(find_up .vimrc)"
  if [ -n "$extravim" ]; then
    echo "Adding extra .vimrc: ${extravim}"
    path_add EXTRA_VIM $extravim
  fi
}
